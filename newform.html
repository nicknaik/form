
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Form Submission</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Inter", sans-serif;
      transition: width 0.3s ease, height 0.3s ease;
    }

    body {
      background-color: #151c4e;
      padding: 30px 0;
    }

    #main-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
    }

    form {
      display: flex;
      justify-content: center;
    }

    #contact-us-form-area {
      width: 70%;

      margin: auto;
      border: 1px solid rgb(215, 215, 215);
      padding: 40px 70px;
      border-radius: 10px;

      background-color: rgb(235, 240, 245);
    }

    #contact-us-form-area .services-list {
      background-color: white;
      display: flex;
      width: 98%;
      /* aspect-ratio: 3/1; */
      justify-content: center;
      padding: 20px 30px 50px;
      margin-top: 0px !important;
      position: relative;
    }

    @media screen and (max-width: 1018px) {
      body {
        padding-bottom: 0;
      }
      #contact-us-form-area {
        width: 100% !important;
        /* padding-bottom: 0px; */
        border-radius: 0;
      }
    }

    .all-checks-btn {
      position: absolute;
      right: 6%;
      bottom: 0px;

      display: flex;
      gap: 15px;
    }

    .services-list-opt-container {
      display: flex;
      flex-wrap: wrap;
      justify-self: flex-start;
      row-gap: 15px;
      column-gap: 9%;
      max-width: fit-content;
      width: max-content;
    }

    input:not([type="checkbox"]),
    #contact-us-form-area .services-list {
      border: 1px solid rgb(125, 125, 125);
      transition: background-color 0.3s ease, border 0.2s ease !important;
    }

    textarea {
      border: 1px solid rgb(125, 125, 125) !important;
      transition: background-color 0.3s ease, border 0.2s ease !important;
    }

    .cus-form-check {
      display: flex;
      align-items: center;
      min-width: 140px;
      flex: 1;
    }

    .form-check-input {
      margin: 10px;
    }

    #contact-us-form-area .services-list .col-md-2 {
      margin: 10px;
    }

    .form-check,
    .form-check-input,
    .form-check-label,
    .cus-form-check label,
    .all-checks-btn>p {
      cursor: pointer;
    }

    .all-checks-btn>p:hover {
      text-decoration: underline;
    }

    .submit-row {
      margin: 30px 0;
      height: 60px;
      display: flex;
      justify-content: center;
    }

    label {
      font-weight: 500;
      width: 100%;
      overflow-wrap: break-word;
    }

    .required {
      color: red;
    }

    #screen-buffer {
      top: 0px;
      position: fixed;
      width: 100%;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.442);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1;

      color: rgb(180, 20, 20);
      text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
      font-size: 18px;
      font-weight: 600;

    }

    #screen-buffer.open {
      display: flex;
    }

    #screen-buffer.close {
      display: none;
    }

    #screen-buffer>img {
      height: 70px;
    }

    .red-glow {
      border: 2px solid rgba(254, 71, 71, 0.882) !important;
      background-color: rgba(255, 0, 0, 0.034) !important;
    }

    .sumbit-form-btn {
      width: 220px;
      height: 50px;
    }
  </style>
</head>

<body>
  <div id="screen-buffer" class="close">
    Sending...
  </div>
  <div id="main-container">
    <!-- <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="235.523" height="52.339"
      viewBox="0 0 235.523 52.339">
      <defs>
        <clipPath id="clip-path">
          <rect id="Rectangle_1" data-name="Rectangle 1" width="235.523" height="52.339" transform="translate(0 0)"
            fill="none" />
        </clipPath>
      </defs>
      <g id="CMIT_Logo_-_Vector" data-name="CMIT Logo - Vector" transform="translate(0 0)">
        <g id="Group_2" data-name="Group 2">
          <g id="Group_1" data-name="Group 1" clip-path="url(#clip-path)">
            <path id="Path_1" data-name="Path 1"
              d="M118.456,24.095c.547.366,1.106.739,1.619,1.157a6.691,6.691,0,0,1,1.369,1.448,5.374,5.374,0,0,1,.52,4.651c-1.468,5.465-6.232,7.345-10.986,7.345a20.666,20.666,0,0,1-3.614-.337c-.99-.178-1.718-.374-2.029-.449l-.164-.04.9-3.331.173.079a13.69,13.69,0,0,0,1.9.747,13.022,13.022,0,0,0,3.814.579c3.063,0,5.738-1.537,6.473-4.271A3.352,3.352,0,0,0,118,28.587a5.26,5.26,0,0,0-1.037-1.01c-.4-.313-.847-.6-1.285-.9l-1.891-1.266c-.5-.336-1.041-.678-1.561-1.061a7.419,7.419,0,0,1-1.443-1.342,4.71,4.71,0,0,1-.724-4.443c1.216-4.528,5.358-6.712,10.047-6.712a19.265,19.265,0,0,1,3.164.267c.871.145,1.543.313,1.958.407l.167.037-.867,3.224-.174-.082a12.343,12.343,0,0,0-5.154-1.1c-2.836,0-5.032,1.494-5.648,3.787a2.655,2.655,0,0,0,.6,2.571,6.512,6.512,0,0,0,1.061.964c.4.3.833.584,1.25.862Z"
              fill="#fff" fill-rule="evenodd" />
            <path id="Path_2" data-name="Path 2"
              d="M123.926,29.254c1.4-5.2,4.522-9.43,9.753-9.43,5.345,0,6.219,4.333,4.826,9.517-1.4,5.2-4.54,9.356-9.806,9.356-5.309,0-6.165-4.259-4.773-9.443m5.343,6.989c2.731,0,4.881-2.571,6.079-7.027s.4-6.939-2.238-6.939c-2.694,0-4.818,2.6-6.006,7.027-1.208,4.5-.438,6.939,2.165,6.939"
              fill="#fff" fill-rule="evenodd" />
            <path id="Path_3" data-name="Path 3" d="M145.662,12.265h2.825L141.5,38.287h-2.825Z" fill="#fff"
              fill-rule="evenodd" />
            <path id="Path_4" data-name="Path 4"
              d="M155.767,34.883a7.446,7.446,0,0,1-6.3,3.814c-3.174,0-3.947-2.712-3.149-5.682l3.433-12.781h2.825l-2.7,10.038c-.86,3.2-1.444,5.562.853,5.562,3.159,0,6.111-4.969,6.973-8.181l1.993-7.419h2.825l-4.849,18.054h-2.825Z"
              fill="#fff" fill-rule="evenodd" />
            <path id="Path_5" data-name="Path 5"
              d="M169.971,38.493l-.105.015a15.689,15.689,0,0,1-2.268.188c-3.617,0-4.633-1.517-3.755-4.79l3.014-11.22H164l.659-2.454h2.853l1.1-4.079,3.313-1.819-1.584,5.9h4.682l-.66,2.454h-4.681l-2.9,10.786c-.31,1.155-.47,2.769,1.9,2.769a4.02,4.02,0,0,0,.929-.094c.264-.06.5-.142.8-.234l.283-.088Z"
              fill="#fff" fill-rule="evenodd" />
            <path id="Path_6" data-name="Path 6"
              d="M178.208,20.233h2.825l-4.849,18.054h-2.825Zm1.191-6.3h3.63l-.989,3.683h-3.63Z" fill="#fff"
              fill-rule="evenodd" />
            <path id="Path_7" data-name="Path 7"
              d="M181.6,29.254c1.4-5.2,4.522-9.43,9.753-9.43,5.345,0,6.218,4.333,4.825,9.517-1.4,5.2-4.539,9.356-9.806,9.356-5.31,0-6.165-4.259-4.773-9.443m5.342,6.989c2.732,0,4.882-2.571,6.079-7.027s.4-6.939-2.239-6.939c-2.694,0-4.818,2.6-6.006,7.027-1.208,4.5-.438,6.939,2.165,6.939"
              fill="#fff" fill-rule="evenodd" />
            <path id="Path_8" data-name="Path 8"
              d="M202.879,23.675a7.538,7.538,0,0,1,6.344-3.852c3.135,0,3.947,2.711,3.149,5.683l-3.434,12.781h-2.825l2.7-10.039c.859-3.2,1.443-5.562-.853-5.562-3.16,0-6.148,4.97-7.011,8.181l-1.992,7.419h-2.825l4.85-18.054H203.8Z"
              fill="#fff" fill-rule="evenodd" />
            <path id="Path_9" data-name="Path 9"
              d="M222,27.971c.393.242.808.488,1.2.769a5,5,0,0,1,1.081,1.014,3.744,3.744,0,0,1,.483,3.458c-.974,3.629-3.959,5.484-8.071,5.484a14.017,14.017,0,0,1-4.608-.753l-.143-.052.706-2.632.166.063c.2.074.761.3,1.521.517a10.135,10.135,0,0,0,2.672.4c2.4,0,4.336-.811,4.856-2.745a1.8,1.8,0,0,0-.589-1.9,5.476,5.476,0,0,0-.835-.627c-.295-.186-.576-.346-.793-.5l-1.343-.856c-.341-.234-.728-.471-1.1-.739a5.453,5.453,0,0,1-1.065-.956,3.425,3.425,0,0,1-.56-3.291c.795-2.958,3.449-4.814,7.378-4.814a12.728,12.728,0,0,1,2.415.231c.66.127,1.181.276,1.56.37l.162.04-.722,2.692-.172-.073a10.221,10.221,0,0,0-3.777-.806c-2.088,0-3.663,1.025-3.974,2.186A1.356,1.356,0,0,0,219,25.954a5.986,5.986,0,0,0,.836.568c.312.184.641.365.94.552Z"
              fill="#fff" fill-rule="evenodd" />
            <path id="Path_10" data-name="Path 10"
              d="M14.962,35.861l-.714,2.263a16.312,16.312,0,0,1-6.984,1.235c-6.5,0-8.748-5.093-6.3-12.86,2.224-7.047,6.448-12.191,13.089-12.191,4.163,0,6.582,1.88,6.665,4.8H15.393c.16-1.594-.223-3.049-2.167-3.049-3.157,0-5.056,3.807-6.614,8.744-2.4,7.614-.56,11.78,3.665,11.78a17.253,17.253,0,0,0,4.685-.72"
              fill="#fff" />
            <path id="Path_11" data-name="Path 11"
              d="M19.814,39.268l5.439-17.231c1.137-3.6.67-4.944-2.131-5.047l.324-1.028,8.832-1.647-1.932,6.59h.093c1.358-1.8,4.857-6.121,9.037-6.121,4.318,0,4.3,3.446,3.893,5.761h.093c1.609-2.006,4.558-5.761,8.737-5.761,5.9,0,4.014,5.967,2.861,9.619L50.368,39.268H45.725l4.432-14.043c1.006-3.189,2.192-6.944-.92-6.944-3.529,0-6.905,5.4-8.074,9.1l-3.75,11.882H32.769l4.205-13.322c1.283-4.064,2.419-7.664-.692-7.664-3.2,0-6.711,4.784-7.863,8.436L24.458,39.268Z"
              fill="#fff" />
            <path id="Path_12" data-name="Path 12"
              d="M56.915,39.222l5.3-17.309c1.112-3.523.488-6.182-2.252-6.282l.351-1.058H68.9l-7.6,24.649Z"
              fill="#fff" />
            <path id="Path_13" data-name="Path 13"
              d="M79.195,16.676H77.3c-2.865,0-3.957.9-5.01,3.606l-.04.1H70.875l1.95-5.821H91.749L90.08,20.5H88.7l.066-.214c.86-2.792.051-3.61-2.722-3.61H83.628l-7.1,22.547H72.091Z"
              fill="#fff" />
            <path id="Path_14" data-name="Path 14" d="M94,25.714a3.7,3.7,0,1,0,4.006-3.422A3.746,3.746,0,0,0,94,25.714"
              fill="#e82727" fill-rule="evenodd" />
            <path id="Path_15" data-name="Path 15"
              d="M99.265,17.1a2.968,2.968,0,1,0,3.261-2.688A3.007,3.007,0,0,0,99.265,17.1" fill="#e82727" />
            <path id="Path_16" data-name="Path 16"
              d="M104.181,9.94A2.565,2.565,0,1,0,107,7.617a2.6,2.6,0,0,0-2.818,2.323" fill="#e82727" />
            <path id="Path_17" data-name="Path 17"
              d="M110.254,5.07a2.267,2.267,0,1,0,2.492-2.054,2.3,2.3,0,0,0-2.492,2.054" fill="#e82727" />
            <path id="Path_18" data-name="Path 18"
              d="M116.975,2.2A2.03,2.03,0,1,0,119.205.363,2.039,2.039,0,0,0,116.975,2.2" fill="#e82727" />
            <path id="Path_19" data-name="Path 19" d="M123.708,1.55a1.7,1.7,0,1,0,3.381.362,1.7,1.7,0,1,0-3.381-.362"
              fill="#e82727" />
            <path id="Path_20" data-name="Path 20"
              d="M129.814,2.3A1.512,1.512,0,1,0,131.475.931,1.518,1.518,0,0,0,129.814,2.3" fill="#e82727" />
            <path id="Path_21" data-name="Path 21"
              d="M134.964,4.909A1.228,1.228,0,1,0,136.313,3.8a1.244,1.244,0,0,0-1.349,1.113" fill="#e82727" />
            <path id="Path_22" data-name="Path 22"
              d="M96.617,35.243a2.968,2.968,0,1,0-3.261,2.689,3.008,3.008,0,0,0,3.261-2.689" fill="#e82727" />
            <path id="Path_23" data-name="Path 23" d="M91.7,42.4a2.565,2.565,0,1,0-2.818,2.323A2.6,2.6,0,0,0,91.7,42.4"
              fill="#e82727" />
            <path id="Path_24" data-name="Path 24"
              d="M85.627,47.269a2.267,2.267,0,1,0-2.491,2.054,2.3,2.3,0,0,0,2.491-2.054" fill="#e82727" />
            <path id="Path_25" data-name="Path 25"
              d="M78.907,50.137a2.03,2.03,0,1,0-2.231,1.838,2.058,2.058,0,0,0,2.231-1.838" fill="#e82727" />
            <path id="Path_26" data-name="Path 26"
              d="M72.174,50.789a1.7,1.7,0,1,0-1.868,1.54,1.724,1.724,0,0,0,1.868-1.54" fill="#e82727" />
            <path id="Path_27" data-name="Path 27"
              d="M66.067,50.038a1.512,1.512,0,1,0-1.661,1.369,1.532,1.532,0,0,0,1.661-1.369" fill="#e82727" />
            <path id="Path_28" data-name="Path 28"
              d="M60.917,47.429a1.228,1.228,0,1,0-1.349,1.112,1.245,1.245,0,0,0,1.349-1.112" fill="#e82727" />
            <path id="Path_29" data-name="Path 29"
              d="M230.09,16.624a2.887,2.887,0,0,0-.847,2.093,2.919,2.919,0,0,0,.842,2.107,2.862,2.862,0,0,0,4.112,0,3.03,3.03,0,0,0,0-4.2,2.857,2.857,0,0,0-4.108,0m4.443,4.533a3.33,3.33,0,0,1-4.779,0,3.372,3.372,0,0,1-.979-2.44,3.335,3.335,0,0,1,.989-2.426,3.34,3.34,0,0,1,4.77,0,3.486,3.486,0,0,1,0,4.866m-1.758-3.742a1.647,1.647,0,0,0-.786-.141h-.556v1.367h.589a1.729,1.729,0,0,0,.62-.084.684.684,0,0,0,.134-1.142m-.7-.595a2.783,2.783,0,0,1,1.012.136.938.938,0,0,1,.576.955.826.826,0,0,1-.364.745,1.39,1.39,0,0,1-.537.183.9.9,0,0,1,.639.37,1.048,1.048,0,0,1,.2.586v.276c0,.088,0,.181.009.281a.607.607,0,0,0,.033.2l.022.047h-.612c0-.012-.006-.025-.009-.037s-.007-.027-.01-.042l-.014-.122v-.3a.934.934,0,0,0-.349-.866,1.548,1.548,0,0,0-.726-.121h-.516v1.489h-.653V16.821Z"
              fill="#fff" fill-rule="evenodd" />
          </g>
        </g>
      </g>
    </svg> -->
      <img src="https://organizein.com/wp-content/uploads/2021/02/logoor.png" alt="Organizein">
    <div id="contact-us-form-area">

      <form id="contact-us-form" class="row g-3">
        <div class="col-md-6">
          <label for="firstname" class="form-label">
            Firstname
            <span class="required">*</span>
          </label>
          <input type="text" class="form-control" id="firstname" required>
        </div>
        <div class="col-md-6">
          <label for="lastname" class="form-label">
            Lastname
            <span class="required">*</span>
          </label>
          <input type="text" class="form-control" id="lastname" required>
        </div>
        <div class="col-md-6">
          <label for="email" class="form-label">
            Email
            <span class="required">*</span>
          </label>
          <input type="email" class="form-control" id="email" required>
        </div>
        <div class="col-md-6">
          <label for="phone" class="form-label">
            Phone
            <span class="required">*</span>
          </label>
          <input type="tel" name="phone" maxlength="14" title="Ten digit number" class="form-control" id="phone"
            onkeyup="formatAndSetPhoneNumber(event)" onpaste="handlePhoneNumberPaste(event)" required>
        </div>
        <div class="col-md-6">
          <label for="company" class="form-label">
            Company
            <span class="required">*</span>
          </label>
          <input type="text" class="form-control" id="company" required>
        </div>
        <div class="col-md-6">
          <label for="zip" class="form-label">
            Zip Code
            <span class="required">*</span>
          </label>
          <input type="tel" pattern="[0-9]{3}[0-9]{3}" maxlength="6" title="Six digits Zip code" max="99999" class="form-control"
            id="zip" oninput="numberOnly(event)" required>
        </div>

        <label id="interested-service" class="form-label">
          Services I am Interested In
          <span class="required">*</span>
        </label>
        <div class="services-list col-12 form-control">
          <div class="services-list-opt-container">

            <div class="cus-form-check">
              <input type="checkbox" name="cloud_service" id="cloud_service" class="form-check-input">
              <label for="cloud_service">Digital Marketing</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="compliance" id="compliance" class="form-check-input">
              <label for="compliance">SEO</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="cybersecurity" id="cybersecurity" class="form-check-input">
              <label for="cybersecurity">Blogs</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="data_backup_recovery" id="data_backup_recovery" class="form-check-input">
              <label for="data_backup_recovery">Social Media</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="help_desk" id="help_desk" class="form-check-input">
              <label for="help_desk">Help Desk</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="id_guidance" id="id_guidance" class="form-check-input">
              <label for="id_guidance">Web Design</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="id_procurement" id="id_procurement" class="form-check-input">
              <label for="id_procurement">Email Marketing</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="id_support" id="id_support" class="form-check-input">
              <label for="id_support">Analytics</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="managed_services" id="managed_services" class="form-check-input">
              <label for="managed_services">CRM</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="network_management" id="network_management" class="form-check-input">
              <label for="network_management">Google Ads</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="productivity_applications" id="productivity_applications"
                class="form-check-input">
              <label for="productivity_applications">Paid Ads</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="unified_communications" id="unified_communications" class="form-check-input">
              <label for="unified_communications">Landing Pages</label>
            </div>

            <div class="cus-form-check">
              <input type="checkbox" name="other" id="other" class="form-check-input">
              <label for="other">Other</label>
            </div>

          </div>
          <div class="all-checks-btn">
            <p id="select-all-services"
              class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover">Select All
            </p>
            <p id="deselect-all-services"
              class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover">Deselect
              All</p>
          </div>
        </div>

        <div class="col-12">
          <div class="col-12">
            <label for="desc" class="form-label">
              Tell us how we can help you...
              <span class="required">*</span>
            </label>
            <textarea name="desc" class="form-control" id="desc" cols="30" rows="10" required></textarea>
          </div>
        </div>

        <div class="submit-row col-12">
          <button type="submit" class="btn btn-danger sumbit-form-btn">Contact Us</button>
        </div>
      </form>
    </div>
  </div>

</body>

</html>
<!-- <script src="index.js"></script> -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<script src="https://js.sentry-cdn.com/examplePublicKey.min.js" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js">
</script>
<script type="text/javascript">
  (function () {
    emailjs.init("BnYfMY08e3N6_ypsC");
  })();
</script>
<script>

  const googleSheetAppScripURL = "https://script.google.com/macros/s/AKfycbyOwFlS0YqqHYb4FrU7rEPJS3DIEVS9-6qCR1JZi5PE516gAVYjJF05nvYc0HPshxvv6A/exec";
  const emailJsServiceId = "service_ws5mezb";
  const emailJsTemplateId_Admin = "template_zupvz0z";
  const emailJsTemplateId_Client = "template_pi1m25n";


  const contactUsForm = document.forms["contact-us-form"];
  const screenBuffer = document.querySelector("#screen-buffer");

  const firstnameInp = contactUsForm.querySelector("#firstname");
  const lastnameInp = contactUsForm.querySelector("#lastname");
  const emailInp = contactUsForm.querySelector("#email");
  const phoneInp = contactUsForm.querySelector("#phone");
  const companyInp = contactUsForm.querySelector("#company");
  const zipCodeInp = contactUsForm.querySelector("#zip");
  const interestedService = contactUsForm.querySelector("#interested-service");
  const servicesList = contactUsForm.querySelector(".services-list");
  const cloudServiceInp = contactUsForm.querySelector("#cloud_service");
  const ComplianceInp = contactUsForm.querySelector("#compliance");
  const CybersecurityInp = contactUsForm.querySelector("#cybersecurity");
  const dataBackupRecoveryInp = contactUsForm.querySelector("#data_backup_recovery");
  const helpDeskInp = contactUsForm.querySelector("#help_desk");
  const itGuidanceInp = contactUsForm.querySelector("#id_guidance");
  const idProcurementInp = contactUsForm.querySelector("#id_procurement");
  const itSupportInp = contactUsForm.querySelector("#id_support");
  const managedServicesInp = contactUsForm.querySelector("#managed_services");
  const networkManagementInp = contactUsForm.querySelector("#network_management");
  const productivityApplicationsInp = contactUsForm.querySelector("#productivity_applications");
  const unifiedCommunicationsInp = contactUsForm.querySelector("#unified_communications");
  const otherInp = contactUsForm.querySelector("#other");
  const descInp = contactUsForm.querySelector("#desc");

  const selectAllServices = contactUsForm.querySelector("#select-all-services");
  const deselectAllServices = contactUsForm.querySelector("#deselect-all-services");

  contactUsForm.addEventListener('submit', e => {
    e.preventDefault();

    const firstname = firstnameInp.value.trim();
    const lastname = lastnameInp.value.trim();
    const email = emailInp.value.trim();
    const phone = phoneInp.value.replace(/\D/g, '');
    const company = companyInp.value.trim();
    const zipCode = zipCodeInp.value.trim();
    const cloudService = cloudServiceInp.checked;
    const Compliance = ComplianceInp.checked;
    const Cybersecurity = CybersecurityInp.checked;
    const dataBackupRecovery = dataBackupRecoveryInp.checked;
    const helpDesk = helpDeskInp.checked;
    const itGuidance = itGuidanceInp.checked;
    const idProcurement = idProcurementInp.checked;
    const itSupport = itSupportInp.checked;
    const managedServices = managedServicesInp.checked;
    const networkManagement = networkManagementInp.checked;
    const productivityApplications = productivityApplicationsInp.checked;
    const unifiedCommunications = unifiedCommunicationsInp.checked;
    const other = otherInp.checked;
    const desc = descInp.value.trim();


    if (!firstname) {
      firstnameInp.scrollIntoView({ behavior: 'smooth', block: 'center' });
      redGlowField(firstnameInp);
      return;
    }
    if (!lastname) {
      lastnameInp.scrollIntoView({ behavior: 'smooth', block: 'center' });
      redGlowField(lastnameInp);
      return;
    }
    if (!email) {
      emailInp.scrollIntoView({ behavior: 'smooth', block: 'center' });
      redGlowField(emailInp);
      return;
    }
    if (!phone) {
      phoneInp.scrollIntoView({ behavior: 'smooth', block: 'center' });
      redGlowField(phoneInp);
      return;
    }
    if (!company) {
      companyInp.scrollIntoView({ behavior: 'smooth', block: 'center' });
      redGlowField(companyInp);
      return;
    }
    if (!zipCode) {
      zipCode.scrollIntoView({ behavior: 'smooth', block: 'center' });
      redGlowField(zipCodeInp);
      return;
    }
    let interestedServiceSelected = cloudService || Compliance || Cybersecurity || dataBackupRecovery || helpDesk || itGuidance || idProcurement || itSupport || managedServices || networkManagement || productivityApplications || unifiedCommunications || other;
    if (!interestedServiceSelected) {
      interestedService.scrollIntoView({ behavior: 'smooth', block: 'center' });
      redGlowField(servicesList);
      return;
    }
    if (!desc) {
      descInp.scrollIntoView({ behavior: 'smooth', block: 'center' });
      redGlowField(descInp);
      return;
    }

    let formData = {
      firstname,
      lastname,
      email,
      phone,
      company,
      zipCode,
      cloudService,
      Compliance,
      Cybersecurity,
      dataBackupRecovery,
      helpDesk,
      itGuidance,
      idProcurement,
      itSupport,
      managedServices,
      networkManagement,
      productivityApplications,
      unifiedCommunications,
      other,
      description: desc,
      date: new Date(),
    }

    bufferOn();
    fetch(googleSheetAppScripURL, { method: 'POST', body: objectToFormData(formData) })
      .then(response => {
        try {
          sendEmail(formData);
        } catch (error) { console.log(error) }

        bufferOff();
        redirectToThankYouPage();

        firstnameInp.value = null;
        lastnameInp.value = null;
        emailInp.value = null;
        phoneInp.value = null;
        companyInp.value = null;
        zipCodeInp.value = null;
        deselectAllServicesFun();
        descInp.value = null;
      })
      .catch(error => {
        bufferOff();
        console.error('Error!', error.message)
        alert("Failed to send message! Please Try Again...")
      });
  })


  function objectToFormData(obj) {
    const formData = new FormData();

    for (const key in obj) {
      if (obj.hasOwnProperty(key)) {
        formData.append(key, obj[key]);
      }
    }

    return formData;
  }

  function sendEmail(formDataObject) {
    const email = formDataObject.email;

    emailjs.send(emailJsServiceId, emailJsTemplateId_Admin, formDataObject)
      .then(function (response) {
        console.log('SUCCESS!', response.status, response.text);
      }, function (error) {
        console.log('FAILED...', error);
      });

    emailjs.send(emailJsServiceId, emailJsTemplateId_Client, formDataObject)
      .then(function (response) {
        console.log('SUCCESS!', response.status, response.text);
      }, function (error) {
        console.log('FAILED...', error);
      });
  }

  function bufferOn() {
    screenBuffer.classList.remove("close");
    screenBuffer.classList.add("open")
  }

  function bufferOff() {
    screenBuffer.classList.remove("open");
    screenBuffer.classList.add("close")
  }

  function redGlowField(field) {
    try {
      let redGlowClass = "red-glow";
      field.classList.add(redGlowClass);
      console.log(field)
      setTimeout(() => field.classList.remove(redGlowClass), 700)
    } catch (error) {
      console.error("Error!", error)
    }
  }


  selectAllServices.addEventListener("click", selectAllServicesFun);
  deselectAllServices.addEventListener("click", deselectAllServicesFun);

  function selectAllServicesFun() {
    cloudServiceInp.checked = true;
    ComplianceInp.checked = true;
    CybersecurityInp.checked = true;
    dataBackupRecoveryInp.checked = true;
    helpDeskInp.checked = true;
    itGuidanceInp.checked = true;
    idProcurementInp.checked = true;
    itSupportInp.checked = true;
    managedServicesInp.checked = true;
    networkManagementInp.checked = true;
    productivityApplicationsInp.checked = true;
    unifiedCommunicationsInp.checked = true;
    otherInp.checked = true;
  }

  function deselectAllServicesFun() {
    cloudServiceInp.checked = null;
    ComplianceInp.checked = null;
    CybersecurityInp.checked = null;
    dataBackupRecoveryInp.checked = null;
    helpDeskInp.checked = null;
    itGuidanceInp.checked = null;
    idProcurementInp.checked = null;
    itSupportInp.checked = null;
    managedServicesInp.checked = null;
    networkManagementInp.checked = null;
    productivityApplicationsInp.checked = null;
    unifiedCommunicationsInp.checked = null;
    otherInp.checked = null;
  }

  function numberOnly(event) {
    event.currentTarget.value = event.currentTarget.value != null ? event.currentTarget.value.replace(/\D/g, '') : "";
  }

  function formatPhoneNumber(phoneNumber) {
    const numericPhoneNumber = phoneNumber.replace(/\D/g, '');

    if (numericPhoneNumber.length === 10) {
      // Format the phone number as (XXX) XXX-XXXX
      return `(${numericPhoneNumber.substring(0, 3)}) ${numericPhoneNumber.substring(3, 6)}-${numericPhoneNumber.substring(6)}`;
    }

    // If it doesn't look like a phone number, remove invalid characters and format
    const cleanedNumeric = numericPhoneNumber.slice(0, 10); // Keep the first 10 characters
    return `(${cleanedNumeric.substring(0, 3)}) ${cleanedNumeric.substring(3, 6)}-${cleanedNumeric.substring(6)}`;
  }

  function formatAndSetPhoneNumber(event) {
    if(!isWritableKey(event)) return;

    const inputField = event.target;
    const currentCursorPosition = inputField.selectionStart;
    const formattedPhoneNumber = formatPhoneNumber(inputField.value);

    inputField.value = formattedPhoneNumber;
  }

  function handlePhoneNumberPaste(event) {
    setTimeout(function () {
      const inputField = event.target;
      const currentCursorPosition = inputField.selectionStart;
      const formattedPhoneNumber = formatPhoneNumber(inputField.value);
      }, 10);
  }

  function isWritableKey(event) {
      return (event.key.length === 1 && !event.ctrlKey && !event.altKey);
  }

  function redirectToThankYouPage() {
    window.location.href = 'https://cmitsolutions.com/tribeca-ny-1166/thank-you/';
  }

</script>